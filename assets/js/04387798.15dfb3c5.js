"use strict";(self.webpackChunkfacturapi_docs=self.webpackChunkfacturapi_docs||[]).push([["6040"],{6586:function(e,n,a){a.r(n),a.d(n,{frontMatter:()=>o,toc:()=>d,default:()=>m,metadata:()=>r,assets:()=>u,contentTitle:()=>l});var r=JSON.parse('{"id":"guides/invoices/async-invoices","title":"Facturaci\xf3n as\xedncrona","description":"Cuando el tama\xf1o de tus facturas es muy grande, o necesitas facturar muchas facturas al mismo tiempo, es recomendable (y en algunos casos requerido) utilizar la facturaci\xf3n as\xedncrona. Esto te permite registrar una factura en Facturapi","source":"@site/docs/guides/invoices/async-invoices.mdx","sourceDirName":"guides/invoices","slug":"/guides/invoices/async-invoices","permalink":"/docs/guides/invoices/async-invoices","draft":false,"unlisted":false,"editUrl":"https://github.com/facturapi/facturapi-docs/edit/main/website/docs/guides/invoices/async-invoices.mdx","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9},"sidebar":"tutorialSidebar","previous":{"title":"Relaci\xf3n entre CFDI","permalink":"/docs/guides/invoices/relacionados"},"next":{"title":"Personalizaci\xf3n de facturas","permalink":"/docs/guides/invoices/customization"}}'),t=a(74848),i=a(84429),s=a(84109),c=a(93703);let o={sidebar_position:9},l="Facturaci\xf3n as\xedncrona",u={},d=[{value:"Crear una factura as\xedncrona",id:"crear-una-factura-as\xedncrona",level:2},{value:"Petici\xf3n",id:"petici\xf3n",level:3},{value:"Response",id:"response",level:3}];function p(e){let n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"facturaci\xf3n-as\xedncrona",children:"Facturaci\xf3n as\xedncrona"})}),"\n",(0,t.jsx)(n.p,{children:"Cuando el tama\xf1o de tus facturas es muy grande, o necesitas facturar muchas facturas al mismo tiempo, es recomendable (y en algunos casos requerido) utilizar la facturaci\xf3n as\xedncrona. Esto te permite registrar una factura en Facturapi\ny recibir una respuesta inmediata con el objeto Invoice y su ID, pero sin timbrar todav\xeda. El timbrado de la factura se realiza en segundo plano, y puedes consultar el estado de la factura en cualquier momento\npor medio del m\xe9todo de obtener factura."}),"\n",(0,t.jsx)(n.h2,{id:"crear-una-factura-as\xedncrona",children:"Crear una factura as\xedncrona"}),"\n",(0,t.jsx)(n.p,{children:"Una factura se crear\xe1 de manera as\xedncrona en cualquiera de estos 2 casos:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Si se env\xeda el par\xe1metro ",(0,t.jsx)(n.code,{children:"async"})," con el valor ",(0,t.jsx)(n.code,{children:"true"})," al crear la factura."]}),"\n",(0,t.jsx)(n.li,{children:"Si el tama\xf1o de la informaci\xf3n enviada excede los 2MB (CFDIs con alrededor de 5,000 elementos o con un complemento de carta porte muy extenso)."}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["En cualquiera de los 2 casos recibir\xe1s el objeto invoice como respuesta, con el campo ",(0,t.jsx)(n.code,{children:"status"})," en ",(0,t.jsx)(n.code,{children:"pending"}),". Esto significa que la factura se est\xe1 procesando en segundo plano. Mientras esto ocurre, es importante\nse\xf1alar que los campos ",(0,t.jsx)(n.code,{children:"stamp"})," y ",(0,t.jsx)(n.code,{children:"uuid"})," ser\xe1n null. Una vez timbrada la factura, el campo ",(0,t.jsx)(n.code,{children:"status"})," cambiar\xe1 a ",(0,t.jsx)(n.code,{children:"valid"})," y se llenar\xe1n los campos ",(0,t.jsx)(n.code,{children:"stamp"})," y ",(0,t.jsx)(n.code,{children:"uuid"})," con la informaci\xf3n del timbrado."]}),"\n",(0,t.jsx)(n.h3,{id:"petici\xf3n",children:"Petici\xf3n"}),"\n",(0,t.jsxs)(s.A,{groupId:"codeExamples",children:[(0,t.jsx)(c.A,{value:"js",label:"Node.js",default:!0,children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"const invoice = await facturapi.invoices.create({\n  customer: {\n    legal_name: 'Dunder Mifflin',\n    email: 'email@example.com',\n    tax_id: 'ABC101010111',\n    tax_system: '601',\n    address: {\n      zip: '85900'\n    }\n  },\n  items: [{\n    quantity: 2,\n    product: {\n      description: 'Ukelele',\n      product_key: '60131324', // ClaveProdServ del SAT\n      price: 345.60,\n      taxes: [\n        {\n          type: 'IVA',\n          rate: 0.16\n        }\n      ]\n    }\n  }],\n  use: 'G01',\n  payment_form: \"28\" // \"Tarjeta de d\xe9bito\"\n}, { async: true });\n"})})}),(0,t.jsx)(c.A,{value:"cs",label:"C#",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'var invoice = await facturapi.Invoice.CreateAsync(new Dictionary<string, object>\n{\n  ["customer"] = new Dictionary<string, object>\n  {\n    ["legal_name"] = "Dunder Mifflin",\n    ["email"] = "email@example.com",\n    ["tax_id"] = "ABC101010111",\n    ["tax_system"] = "601",\n    ["address"] = new Dictionary<string, object>\n    {\n      ["zip"] = "85900"\n    },\n  },\n  ["items"] = new List<Dictionary<string, object>>\n  {\n    new Dictionary<string, object>\n    {\n      ["quantity"] = 2,\n      ["product"] = new Dictionary<string, object>\n      {\n        ["description"] = "Ukelele",\n        ["product_key"] = "60131324",\n        ["price"] = 345.60,\n        ["taxes"] = new List<Dictionary<string, object>>\n        {\n          new Dictionary<string, object>\n          {\n            ["type"] = "IVA",\n            ["rate"] = 0.16\n          }\n        }\n      }\n    }\n  },\n  ["use"] = "G01",\n  ["payment_form"] = "28" // "Tarjeta de d\xe9bito"\n}, new Dictionary<string, object>\n{\n  ["async"] = true\n});\n'})})}),(0,t.jsx)(c.A,{value:"php",label:"PHP",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:'$invoice = $facturapi->Invoices->create([\n  "customer" => [\n    "legal_name" => "Dunder Mifflin",\n    "email" => "email@example.com",\n    "tax_id" => "ABC101010111",\n    "tax_system" => "601",\n    "address" => [\n      "zip" => "85900"\n    ]\n  ],\n  "items" => [\n    [\n      "quantity" => 2,\n      "product" => [\n        "description" => "Ukelele",\n        "product_key" => "60131324",\n        "price" => 345.60,\n        "taxes" => [\n          [\n            "type" => "IVA",\n            "rate" => 0.16\n          ]\n        ]\n      ]\n    ]\n  ],\n  "use" => "G01",\n  "payment_form" => "28" // "Tarjeta de d\xe9bito"\n], [\n  "async" => true\n]);\n'})})}),(0,t.jsx)(c.A,{value:"curl",label:"cURL",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl https://www.facturapi.io/v2/invoices \\\n  -H "Authorization Bearer sk_test_API_KEY" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "customer": {\n      "legal_name": "Dunder Mifflin",\n      "email": "email@example.com",\n      "tax_id": "ABC101010111",\n      "tax_system": "601",\n      "address": {\n        "zip": "85900"\n      }\n    },\n    "items": [\n      {\n        "quantity": 2,\n        "product": {\n          "description": "Ukelele",\n          "product_key": "60131324",\n          "price": 345.60,\n          "taxes": [\n            {\n              "type": "IVA",\n              "rate": 0.16\n            }\n          ]\n        }\n      }\n    ],\n    "use": "G01",\n    "payment_form": "28" // "Tarjeta de d\xe9bito"\n  }\'\n'})})})]}),"\n",(0,t.jsx)(n.h3,{id:"response",children:"Response"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "5f4b1b4b4b4b4b4b4b4b4b4a",\n  "created_at": "2020-08-29T00:00:00.000Z",\n  "status": "pending",\n  "customer": {\n    "id": "5f4b1b4b4b4b4b4b4b4b4b4b",\n    "legal_name": "Dunder Mifflin",\n    "email": "email@example.com",\n    "tax_id": "ABC101010111",\n    "tax_system": "601",\n    "address": {\n      "country": "MEX",\n      "zip": "85900"\n    }\n  },\n  "items": [\n    {\n      "quantity": 2,\n      "product": {\n        "description": "Ukelele",\n        "product_key": "60131324",\n        "price": 345.60,\n        "taxes": [\n          {\n            "type": "IVA",\n            "rate": 0.16\n          }\n        ]\n      }\n    }\n  ],\n  "use": "G01",\n  "payment_form": "28",\n  "stamp": null,\n  "uuid": null\n}\n'})})]})}function m(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}},93703:function(e,n,a){a.d(n,{A:()=>i});var r=a(74848);a(96540);var t=a(39836);function i({children:e,hidden:n,className:a}){return(0,r.jsx)("div",{role:"tabpanel",className:(0,t.A)("tabItem_Ymn6",a),hidden:n,children:e})}},84109:function(e,n,a){a.d(n,{A:()=>y});var r=a(74848),t=a(96540),i=a(39836),s=a(16364),c=a(68251),o=a(56347),l=a(28004),u=a(25580),d=a(12213),p=a(75734);function m(e){return t.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,t.isValidElement)(e)&&function(e){let{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function f({value:e,tabValues:n}){return n.some(n=>n.value===e)}var h=a(98864);function b({className:e,block:n,selectedValue:a,selectValue:t,tabValues:s}){let o=[],{blockElementScrollPositionUntilNextRender:l}=(0,c.a_)(),u=e=>{let n=e.currentTarget,r=s[o.indexOf(n)].value;r!==a&&(l(n),t(r))},d=e=>{let n=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{let a=o.indexOf(e.currentTarget)+1;n=o[a]??o[0];break}case"ArrowLeft":{let a=o.indexOf(e.currentTarget)-1;n=o[a]??o[o.length-1]}}n?.focus()};return(0,r.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":n},e),children:s.map(({value:e,label:n,attributes:t})=>(0,r.jsx)("li",{role:"tab",tabIndex:a===e?0:-1,"aria-selected":a===e,ref:e=>{o.push(e)},onKeyDown:d,onClick:u,...t,className:(0,i.A)("tabs__item","tabItem_LNqP",t?.className,{"tabs__item--active":a===e}),children:n??e},e))})}function v({lazy:e,children:n,selectedValue:a}){let s=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){let e=s.find(e=>e.props.value===a);return e?(0,t.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,r.jsx)("div",{className:"margin-top--md",children:s.map((e,n)=>(0,t.cloneElement)(e,{key:n,hidden:e.props.value!==a}))})}function x(e){let n=function(e){let n,{defaultValue:a,queryString:r=!1,groupId:i}=e,s=function(e){let{values:n,children:a}=e;return(0,t.useMemo)(()=>{let e=n??m(a).map(({props:{value:e,label:n,attributes:a,default:r}})=>({value:e,label:n,attributes:a,default:r})),r=(0,d.XI)(e,(e,n)=>e.value===n.value);if(r.length>0)throw Error(`Docusaurus error: Duplicate values "${r.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`);return e},[n,a])}(e),[c,h]=(0,t.useState)(()=>(function({defaultValue:e,tabValues:n}){if(0===n.length)throw Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!f({value:e,tabValues:n}))throw Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}let a=n.find(e=>e.default)??n[0];if(!a)throw Error("Unexpected error: 0 tabValues");return a.value})({defaultValue:a,tabValues:s})),[b,v]=function({queryString:e=!1,groupId:n}){let a=(0,o.W6)(),r=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,u.aZ)(r),(0,t.useCallback)(e=>{if(!r)return;let n=new URLSearchParams(a.location.search);n.set(r,e),a.replace({...a.location,search:n.toString()})},[r,a])]}({queryString:r,groupId:i}),[x,y]=function({groupId:e}){let n=e?`docusaurus.tab.${e}`:null,[a,r]=(0,p.Dv)(n);return[a,(0,t.useCallback)(e=>{n&&r.set(e)},[n,r])]}({groupId:i}),j=f({value:n=b??x,tabValues:s})?n:null;return(0,l.A)(()=>{j&&h(j)},[j]),{selectedValue:c,selectValue:(0,t.useCallback)(e=>{if(!f({value:e,tabValues:s}))throw Error(`Can't select invalid tab value=${e}`);h(e),v(e),y(e)},[v,y,s]),tabValues:s}}(e);return(0,r.jsxs)("div",{className:(0,i.A)(s.G.tabs.container,"tabs-container","tabList__CuJ"),children:[(0,r.jsx)(b,{...n,...e}),(0,r.jsx)(v,{...n,...e})]})}function y(e){let n=(0,h.A)();return(0,r.jsx)(x,{...e,children:m(e.children)},String(n))}},84429:function(e,n,a){a.d(n,{R:()=>s,x:()=>c});var r=a(96540);let t={},i=r.createContext(t);function s(e){let n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);