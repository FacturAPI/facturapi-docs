"use strict";(self.webpackChunkfacturapi_docs=self.webpackChunkfacturapi_docs||[]).push([["957"],{7052:function(e,n,t){t.r(n),t.d(n,{default:()=>p,frontMatter:()=>c,metadata:()=>i,assets:()=>u,toc:()=>d,contentTitle:()=>l});var i=JSON.parse('{"id":"guides/invoices/async-invoices","title":"Async invoicing","description":"When the size of your invoices is very large, or you need to invoice many invoices at the same time, it is advisable (and in some cases required) to use asynchronous invoicing. This allows you to register an invoice in Facturapi","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/guides/invoices/async-invoices.mdx","sourceDirName":"guides/invoices","slug":"/guides/invoices/async-invoices","permalink":"/en/docs/guides/invoices/async-invoices","draft":false,"unlisted":false,"editUrl":"https://github.com/facturapi/facturapi-docs/edit/main/website/docs/guides/invoices/async-invoices.mdx","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9},"sidebar":"tutorialSidebar","previous":{"title":"Relationships","permalink":"/en/docs/guides/invoices/relacionados"},"next":{"title":"Invoice Customization","permalink":"/en/docs/guides/invoices/customization"}}'),a=t("5893"),r=t("65"),s=t("8168"),o=t("7645");let c={sidebar_position:9},l="Async invoicing",u={},d=[{value:"Create an asynchronous invoice",id:"create-an-asynchronous-invoice",level:2},{value:"Request",id:"request",level:3},{value:"Response",id:"response",level:3}];function h(e){let n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"async-invoicing",children:"Async invoicing"})}),"\n",(0,a.jsx)(n.p,{children:"When the size of your invoices is very large, or you need to invoice many invoices at the same time, it is advisable (and in some cases required) to use asynchronous invoicing. This allows you to register an invoice in Facturapi\nand receive an immediate response with the Invoice object and its ID, but without stamping yet. The stamping of the invoice is done in the background, and you can check the status of the invoice at any time\nusing the get invoice method."}),"\n",(0,a.jsx)(n.h2,{id:"create-an-asynchronous-invoice",children:"Create an asynchronous invoice"}),"\n",(0,a.jsx)(n.p,{children:"An invoice will be created asynchronously in either of these 2 cases:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["If the ",(0,a.jsx)(n.code,{children:"async"})," parameter is sent with the value ",(0,a.jsx)(n.code,{children:"true"})," when creating the invoice."]}),"\n",(0,a.jsx)(n.li,{children:"If the size of the information sent exceeds 2MB (CFDIs with around 5,000 items or with a very extensive Carta Porte complement)."}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["In either case, you will receive the invoice object as a response, with the ",(0,a.jsx)(n.code,{children:"status"})," field in ",(0,a.jsx)(n.code,{children:"pending"}),". This means that the invoice is being processed in the background. While this is happening, it is important\nto note that the ",(0,a.jsx)(n.code,{children:"stamp"})," and ",(0,a.jsx)(n.code,{children:"uuid"})," fields will be null. Once the invoice is stamped, the ",(0,a.jsx)(n.code,{children:"status"})," field will change to ",(0,a.jsx)(n.code,{children:"valid"})," and the ",(0,a.jsx)(n.code,{children:"stamp"})," and ",(0,a.jsx)(n.code,{children:"uuid"})," fields will be filled with the stamping information."]}),"\n",(0,a.jsx)(n.h3,{id:"request",children:"Request"}),"\n",(0,a.jsxs)(s.Z,{groupId:"codeExamples",children:[(0,a.jsx)(o.Z,{value:"js",label:"Node.js",default:!0,children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-javascript",children:"const invoice = await facturapi.invoices.create({\n  customer: {\n    legal_name: 'Dunder Mifflin',\n    email: 'email@example.com',\n    tax_id: 'ABC101010111',\n    tax_system: '601',\n    address: {\n      zip: '85900'\n    }\n  },\n  items: [{\n    quantity: 2,\n    product: {\n      description: 'Ukelele',\n      product_key: '60131324', // ClaveProdServ del SAT\n      price: 345.60,\n      taxes: [\n        {\n          type: 'IVA',\n          rate: 0.16\n        }\n      ]\n    }\n  }],\n  use: 'G01',\n  payment_form: \"28\" // \"Debit card\"\n}, { async: true });\n"})})}),(0,a.jsx)(o.Z,{value:"cs",label:"C#",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'var invoice = await facturapi.Invoice.CreateAsync(new Dictionary<string, object>\n{\n  ["customer"] = new Dictionary<string, object>\n  {\n    ["legal_name"] = "Dunder Mifflin",\n    ["email"] = "email@example.com",\n    ["tax_id"] = "ABC101010111",\n    ["tax_system"] = "601",\n    ["address"] = new Dictionary<string, object>\n    {\n      ["zip"] = "85900"\n    },\n  },\n  ["items"] = new List<Dictionary<string, object>>\n  {\n    new Dictionary<string, object>\n    {\n      ["quantity"] = 2,\n      ["product"] = new Dictionary<string, object>\n      {\n        ["description"] = "Ukelele",\n        ["product_key"] = "60131324",\n        ["price"] = 345.60,\n        ["taxes"] = new List<Dictionary<string, object>>\n        {\n          new Dictionary<string, object>\n          {\n            ["type"] = "IVA",\n            ["rate"] = 0.16\n          }\n        }\n      }\n    }\n  },\n  ["use"] = "G01",\n  ["payment_form"] = "28" // "Debit card"\n}, new Dictionary<string, object>\n{\n  ["async"] = true\n});\n'})})}),(0,a.jsx)(o.Z,{value:"php",label:"PHP",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-php",children:'$invoice = $facturapi->Invoices->create([\n  "customer" => [\n    "legal_name" => "Dunder Mifflin",\n    "email" => "email@example.com",\n    "tax_id" => "ABC101010111",\n    "tax_system" => "601",\n    "address" => [\n      "zip" => "85900"\n    ]\n  ],\n  "items" => [\n    [\n      "quantity" => 2,\n      "product" => [\n        "description" => "Ukelele",\n        "product_key" => "60131324",\n        "price" => 345.60,\n        "taxes" => [\n          [\n            "type" => "IVA",\n            "rate" => 0.16\n          ]\n        ]\n      ]\n    ]\n  ],\n  "use" => "G01",\n  "payment_form" => "28" // "Debit card"\n], [\n  "async" => true\n]);\n'})})}),(0,a.jsx)(o.Z,{value:"curl",label:"cURL",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl https://www.facturapi.io/v2/invoices \\\n  -H "\n  Authorization Bearer sk_test_API_KEY" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "customer": {\n      "legal_name": "Dunder Mifflin",\n      "email": "email@example.com",\n      "tax_id": "ABC101010111",\n      "tax_system": "601",\n      "address": {\n        "zip": "85900"\n      }\n    },\n    "items": [\n      {\n        "quantity": 2,\n        "product": {\n          "description": "Ukelele",\n          "product_key": "60131324",\n          "price": 345.60,\n          "taxes": [\n            {\n              "type": "IVA",\n              "rate": 0.16\n            }\n          ]\n        }\n      }\n    ],\n    "use": "G01",\n    "payment_form": "28" // "Debit card"\n  }\'\n'})})})]}),"\n",(0,a.jsx)(n.h3,{id:"response",children:"Response"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "id": "5f4b1b4b4b4b4b4b4b4b4b4a",\n  "created_at": "2020-08-29T00:00:00.000Z",\n  "status": "pending",\n  "customer": {\n    "id": "5f4b1b4b4b4b4b4b4b4b4b4b",\n    "legal_name": "Dunder Mifflin",\n    "email": "email@example.com",\n    "tax_id": "ABC101010111",\n    "tax_system": "601",\n    "address": {\n      "country": "MEX",\n      "zip": "85900"\n    }\n  },\n  "items": [\n    {\n      "quantity": 2,\n      "product": {\n        "description": "Ukelele",\n        "product_key": "60131324",\n        "price": 345.60,\n        "taxes": [\n          {\n            "type": "IVA",\n            "rate": 0.16\n          }\n        ]\n      }\n    }\n  ],\n  "use": "G01",\n  "payment_form": "28",\n  "stamp": null,\n  "uuid": null\n}\n'})})]})}function p(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},7645:function(e,n,t){t.d(n,{Z:()=>r});var i=t("5893");t("7294");var a=t("7026");function r(e){let{children:n,hidden:t,className:r}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,a.Z)("tabItem_Ymn6",r),hidden:t,children:n})}},8168:function(e,n,t){t.d(n,{Z:()=>y});var i=t("5893"),a=t("7294"),r=t("7026"),s=t("4718"),o=t("6550"),c=t("8714"),l=t("9207"),u=t("9413"),d=t("4510");function h(e){return a.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||a.isValidElement(e)&&function(e){let{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function p(e){let{value:n,tabValues:t}=e;return t.some(e=>e.value===n)}var m=t("6735");function f(e){let{className:n,block:t,selectedValue:a,selectValue:o,tabValues:c}=e,l=[],{blockElementScrollPositionUntilNextRender:u}=(0,s.o5)(),d=e=>{let n=e.currentTarget,t=c[l.indexOf(n)].value;t!==a&&(u(n),o(t))},h=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{let t=l.indexOf(e.currentTarget)+1;n=l[t]??l[0];break}case"ArrowLeft":{let t=l.indexOf(e.currentTarget)-1;n=l[t]??l[l.length-1]}}n?.focus()};return(0,i.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":t},n),children:c.map(e=>{let{value:n,label:t,attributes:s}=e;return(0,i.jsx)("li",{role:"tab",tabIndex:a===n?0:-1,"aria-selected":a===n,ref:e=>{l.push(e)},onKeyDown:h,onClick:d,...s,className:(0,r.Z)("tabs__item","tabItem_LNqP",s?.className,{"tabs__item--active":a===n}),children:t??n},n)})})}function v(e){let{lazy:n,children:t,selectedValue:s}=e,o=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){let e=o.find(e=>e.props.value===s);return e?(0,a.cloneElement)(e,{className:(0,r.Z)("margin-top--md",e.props.className)}):null}return(0,i.jsx)("div",{className:"margin-top--md",children:o.map((e,n)=>(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==s}))})}function b(e){let n=function(e){let{defaultValue:n,queryString:t=!1,groupId:i}=e,r=function(e){let{values:n,children:t}=e;return(0,a.useMemo)(()=>{let e=n??h(t).map(e=>{let{props:{value:n,label:t,attributes:i,default:a}}=e;return{value:n,label:t,attributes:i,default:a}});return!function(e){let n=(0,u.lx)(e,(e,n)=>e.value===n.value);if(n.length>0)throw Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,t])}(e),[s,m]=(0,a.useState)(()=>(function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!p({value:n,tabValues:t}))throw Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}let i=t.find(e=>e.default)??t[0];if(!i)throw Error("Unexpected error: 0 tabValues");return i.value})({defaultValue:n,tabValues:r})),[f,v]=function(e){let{queryString:n=!1,groupId:t}=e,i=(0,o.k6)(),r=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,l._X)(r),(0,a.useCallback)(e=>{if(!r)return;let n=new URLSearchParams(i.location.search);n.set(r,e),i.replace({...i.location,search:n.toString()})},[r,i])]}({queryString:t,groupId:i}),[b,y]=function(e){let{groupId:n}=e,t=n?`docusaurus.tab.${n}`:null,[i,r]=(0,d.Nk)(t);return[i,(0,a.useCallback)(e=>{t&&r.set(e)},[t,r])]}({groupId:i}),x=(()=>{let e=f??b;return p({value:e,tabValues:r})?e:null})();return(0,c.Z)(()=>{x&&m(x)},[x]),{selectedValue:s,selectValue:(0,a.useCallback)(e=>{if(!p({value:e,tabValues:r}))throw Error(`Can't select invalid tab value=${e}`);m(e),v(e),y(e)},[v,y,r]),tabValues:r}}(e);return(0,i.jsxs)("div",{className:(0,r.Z)("tabs-container","tabList__CuJ"),children:[(0,i.jsx)(f,{...n,...e}),(0,i.jsx)(v,{...n,...e})]})}function y(e){let n=(0,m.Z)();return(0,i.jsx)(b,{...e,children:h(e.children)},String(n))}},65:function(e,n,t){t.d(n,{Z:function(){return o},a:function(){return s}});var i=t(7294);let a={},r=i.createContext(a);function s(e){let n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);