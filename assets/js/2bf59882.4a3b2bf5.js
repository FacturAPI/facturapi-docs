"use strict";(self.webpackChunkfacturapi_docs=self.webpackChunkfacturapi_docs||[]).push([[2261],{1527:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>i,metadata:()=>c,toc:()=>d});var o=n(4848),r=n(8453);const i={sidebar_position:6},s="Migrar de v1 a v2",c={id:"migrate",title:"Migrar de v1 a v2",description:"Cambios generales",source:"@site/docs/migrate.md",sourceDirName:".",slug:"/migrate",permalink:"/docs/migrate",draft:!1,unlisted:!1,editUrl:"https://github.com/facturapi/facturapi-docs/edit/main/website/docs/migrate.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"Formato de fechas",permalink:"/docs/advanced/dates"}},l={},d=[{value:"Cambios generales",id:"cambios-generales",level:2},{value:"Facturas",id:"facturas",level:2},{value:"Nuevos campos requeridos al crear clientes:",id:"nuevos-campos-requeridos-al-crear-clientes",level:3},{value:"Nuevos campos opcionales al crear productos:",id:"nuevos-campos-opcionales-al-crear-productos",level:3},{value:"Nuevos campos opcionales al crear facturas:",id:"nuevos-campos-opcionales-al-crear-facturas",level:3},{value:"Documentos relacionados en facturas",id:"documentos-relacionados-en-facturas",level:3},{value:"Facturas de Egreso (Notas de Cr\xe9dito)",id:"facturas-de-egreso-notas-de-cr\xe9dito",level:3},{value:"Factura global",id:"factura-global",level:3},{value:"Usando el m\xe9todo Crear Factura Global ",id:"usando-el-m\xe9todo-crear-factura-global-",level:4},{value:"Usando el m\xe9todo Crear Factura",id:"usando-el-m\xe9todo-crear-factura",level:4},{value:"Acuse de recibo de cancelaci\xf3n",id:"acuse-de-recibo-de-cancelaci\xf3n",level:3},{value:"Comprobante de tipo Pago (recibo electr\xf3nico de pagos)",id:"comprobante-de-tipo-pago-recibo-electr\xf3nico-de-pagos",level:3},{value:"Comprobante de Retenciones (e informaci\xf3n de pagos)",id:"comprobante-de-retenciones-e-informaci\xf3n-de-pagos",level:2},{value:"Organizaciones",id:"organizaciones",level:2},{value:"Llaves secretas o Api Keys",id:"llaves-secretas-o-api-keys",level:3},{value:"Configuraci\xf3n de recibos",id:"configuraci\xf3n-de-recibos",level:3}];function t(e){const a={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.h1,{id:"migrar-de-v1-a-v2",children:"Migrar de v1 a v2"}),"\n",(0,o.jsx)(a.h2,{id:"cambios-generales",children:"Cambios generales"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsxs)(a.li,{children:["La nueva URL de la API es ",(0,o.jsx)(a.code,{children:"https://www.facturapi.io/v2"}),"."]}),"\n",(0,o.jsx)(a.li,{children:"Si usas una de nuestras librer\xedas, aseg\xfarate de actualizar a la \xfaltima versi\xf3n mayor para usar el nuevo endpoint."}),"\n",(0,o.jsx)(a.li,{children:"Ya no se permite enviar atributos desconocidos, es decir, que no formen parte de la estructura descrita en la documentaci\xf3n. Ahora, si se env\xeda un atributo desconocido, la API devolver\xe1 un error."}),"\n",(0,o.jsx)(a.li,{children:"El SAT ahora valida, que tanto para el emisor como para el receptor, coincidan exactamente con los datos registrados ante la autoridad como RFC, raz\xf3n social, r\xe9gimen y c\xf3digo postal; por lo que deber\xe1s revisar los datos del emisor y el receptor antes de enviar la factura."}),"\n",(0,o.jsx)(a.li,{children:"Adem\xe1s de esto el nombre de la raz\xf3n social debe escribirse en may\xfasculas, sin acentos, y en caso de persona moral, sin r\xe9gimen societario (por ejemplo sin S.A. de C.V.)"}),"\n",(0,o.jsxs)(a.li,{children:["Si env\xedas fechas en formato ISO 8601 y no incluyes la zona horaria, ahora la API la interpretar\xe1 como tu hora local (definida por el c\xf3digo postal de tu organizaci\xf3n), en lugar de interpretarla como UTC. Puedes leer m\xe1s a fondo en ",(0,o.jsx)(a.a,{href:"https://docs.facturapi.io/docs/advanced/dates/",children:"este art\xedculo"}),"."]}),"\n"]}),"\n",(0,o.jsx)(a.h2,{id:"facturas",children:"Facturas"}),"\n",(0,o.jsx)(a.h3,{id:"nuevos-campos-requeridos-al-crear-clientes",children:"Nuevos campos requeridos al crear clientes:"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsx)(a.li,{children:(0,o.jsx)(a.code,{children:"tax_system"})}),"\n",(0,o.jsx)(a.li,{children:(0,o.jsx)(a.code,{children:"address.zip"})}),"\n"]}),"\n",(0,o.jsx)(a.h3,{id:"nuevos-campos-opcionales-al-crear-productos",children:"Nuevos campos opcionales al crear productos:"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsx)(a.li,{children:(0,o.jsx)(a.code,{children:"taxability"})}),"\n"]}),"\n",(0,o.jsx)(a.h3,{id:"nuevos-campos-opcionales-al-crear-facturas",children:"Nuevos campos opcionales al crear facturas:"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsxs)(a.li,{children:[(0,o.jsx)(a.code,{children:"items.third_party"})," ",(0,o.jsx)("br",{}),(0,o.jsx)(a.em,{children:"*Opci\xf3n recomendable para emitir facturas a cuenta de terceros; debe utilizarse para sustituir namespaces y complements."})]}),"\n",(0,o.jsx)(a.li,{children:(0,o.jsx)(a.code,{children:"export"})}),"\n",(0,o.jsx)(a.li,{children:(0,o.jsx)(a.code,{children:"global"})}),"\n"]}),"\n",(0,o.jsx)(a.h3,{id:"documentos-relacionados-en-facturas",children:"Documentos relacionados en facturas"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsxs)(a.li,{children:["\n",(0,o.jsx)(a.p,{children:"Ahora una factura puede tener m\xe1s de un tipo de relaci\xf3n con otros documentos,\npor lo que la forma de indicar documentos relacionados cambia de la siguiente manera:"}),"\n",(0,o.jsx)(a.p,{children:"Antes:"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-json",children:'{\n  // ...\n  "relation": "01",\n  "related": ["81DA4E74-4924-4934-8129-497498E076A0"]\n}\n'})}),"\n",(0,o.jsx)(a.p,{children:"Ahora:"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-json",children:'{\n  // ...\n  "related_documents": [\n    {\n      "relationship": "01",\n      "documents": ["81DA4E74-4924-4934-8129-497498E076A0"]\n    }\n  ]\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(a.h3,{id:"facturas-de-egreso-notas-de-cr\xe9dito",children:"Facturas de Egreso (Notas de Cr\xe9dito)"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsxs)(a.li,{children:["Se elimina el atributo ",(0,o.jsx)(a.code,{children:"products"})," y en su lugar se introduce el arreglo ",(0,o.jsx)(a.code,{children:"items"}),", igual que en los dem\xe1s tipos de facturas."]}),"\n"]}),"\n",(0,o.jsx)(a.h3,{id:"factura-global",children:"Factura global"}),"\n",(0,o.jsx)(a.p,{children:"Al crear una factura global, ahora es requerido enviar informaci\xf3n adicional:"}),"\n",(0,o.jsxs)(a.h4,{id:"usando-el-m\xe9todo-crear-factura-global-",children:["Usando el m\xe9todo ",(0,o.jsx)(a.a,{href:"/api/#operation/createGlobalInvoice",children:"Crear Factura Global "})]}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsxs)(a.li,{children:["Nuevo atributo ",(0,o.jsx)(a.code,{children:"periodicity"}),". Es opcional porque de omitirse se tomar\xe1 de la\nconfiguraci\xf3n de recibos de la organizaci\xf3n, pero es importante asegurarse de\nque efectivamente tenga el valor que quieres que salga en la factura."]}),"\n",(0,o.jsxs)(a.li,{children:["El rango de fechas que se forma de los atributos ",(0,o.jsx)(a.code,{children:"from"})," y ",(0,o.jsx)(a.code,{children:"to"})," debe coincidir\ncon el periodo definido por medio del atributo ",(0,o.jsx)(a.code,{children:"periodicity"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(a.h4,{id:"usando-el-m\xe9todo-crear-factura",children:["Usando el m\xe9todo ",(0,o.jsx)(a.a,{href:"/api/#operation/crateInvoice",children:"Crear Factura"})]}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsxs)(a.li,{children:["Nuevo atributo ",(0,o.jsx)(a.code,{children:"global"}),", que es un objeto con los atributos ",(0,o.jsx)(a.code,{children:"periodicity"}),", ",(0,o.jsx)(a.code,{children:"months"})," y ",(0,o.jsx)(a.code,{children:"year"}),"."]}),"\n"]}),"\n",(0,o.jsx)(a.h3,{id:"acuse-de-recibo-de-cancelaci\xf3n",children:"Acuse de recibo de cancelaci\xf3n"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsxs)(a.li,{children:["Anteriormente, era posible obtener el acuse de cancelaci\xf3n de una factura cancelada por medio de la\npropiedad ",(0,o.jsx)(a.code,{children:"cancellation_receipt"})," del objeto ",(0,o.jsx)(a.code,{children:"Invoice"}),". Ahora la manera de obtener el acuse de cancelaci\xf3n es\nmediante el m\xe9todo ",(0,o.jsx)(a.a,{href:"/api/#operation/getCancellationReceipt",children:"Obtener Acuse de Cancelaci\xf3n"}),"."]}),"\n"]}),"\n",(0,o.jsx)(a.h3,{id:"comprobante-de-tipo-pago-recibo-electr\xf3nico-de-pagos",children:"Comprobante de tipo Pago (recibo electr\xf3nico de pagos)"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsxs)(a.li,{children:["La informaci\xf3n del ocmplemento de Pago ya no se enviar\xe1 por medio del atributo ",(0,o.jsx)(a.code,{children:"payments"}),", sino que se incluir\xe1 como complemento con tipo ",(0,o.jsx)(a.code,{children:"pago"})," en una factura de tipo ",(0,o.jsx)(a.code,{children:"P"})," (Pago)."]}),"\n"]}),"\n",(0,o.jsx)(a.h2,{id:"comprobante-de-retenciones-e-informaci\xf3n-de-pagos",children:"Comprobante de Retenciones (e informaci\xf3n de pagos)"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsxs)(a.li,{children:["Se elimina el atributo ",(0,o.jsx)(a.code,{children:"totales.imp_retenidos[].pago_provisional"})," y en su lugar debe usarse el nuevo atributo ",(0,o.jsx)(a.code,{children:"totales.imp_retenidos[].tipo_pago_ret"}),"."]}),"\n"]}),"\n",(0,o.jsx)(a.h2,{id:"organizaciones",children:"Organizaciones"}),"\n",(0,o.jsx)(a.h3,{id:"llaves-secretas-o-api-keys",children:"Llaves secretas o Api Keys"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsxs)(a.li,{children:["Como medida de seguridad, ya no es posible obtener la llave secreta Live de una organizaci\xf3n. Se elimina el m\xe9todo ",(0,o.jsx)(a.code,{children:"getApiKeys"})," y en su lugar se introducen los m\xe9todos ",(0,o.jsx)(a.code,{children:"getTestApiKey"}),", ",(0,o.jsx)(a.code,{children:"renewTestApiKey"})," y ",(0,o.jsx)(a.code,{children:"renewLiveApiKey"}),". Los dos \xfaltimos pueden ser usados para generar nuevas llaves secretas, sustituyendo a las actuales, y en la respuesta se incluye la nueva llave generada. Para el caso de la llave secreta Live, el momento de su creaci\xf3n ser\xe1 la \xfanica oportunidad para leer el valor."]}),"\n"]}),"\n",(0,o.jsx)(a.h3,{id:"configuraci\xf3n-de-recibos",children:"Configuraci\xf3n de recibos"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsxs)(a.li,{children:["La propiedad ",(0,o.jsx)(a.code,{children:"organization.receipts.invoice_period"})," fue renombrada\na ",(0,o.jsx)(a.code,{children:"organization.receipts.periodicity"}),"."]}),"\n",(0,o.jsxs)(a.li,{children:["Se elimin\xf3 la propiedad ",(0,o.jsx)(a.code,{children:"organization.receipts.ask_address"}),". Ahora en el portal de autofactura siempre\nse solicita el domicilio fiscal."]}),"\n"]})]})}function u(e={}){const{wrapper:a}={...(0,r.R)(),...e.components};return a?(0,o.jsx)(a,{...e,children:(0,o.jsx)(t,{...e})}):t(e)}},8453:(e,a,n)=>{n.d(a,{R:()=>s,x:()=>c});var o=n(6540);const r={},i=o.createContext(r);function s(e){const a=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function c(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),o.createElement(i.Provider,{value:a},e.children)}}}]);